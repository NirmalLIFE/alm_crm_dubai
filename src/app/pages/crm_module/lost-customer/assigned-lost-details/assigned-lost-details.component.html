<ol class="flex font-semibold text-primary dark:text-white-dark">
    <li class="bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]">
        <a routerLink="/dashboard"
            class="relative flex h-full items-center p-1.5 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-3 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-3 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">Home</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180">Assigned
            Calls</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a routerLink="/lost-customer/assigned-lost-count"
            class="relative flex h-full items-center p-1.5 px-3 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-6 ltr:before:-right-[15px] rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">Assigned
            Lost Customer</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180">Assigned
            Lost Customers Details</a>
    </li>
</ol>
<div>
    <div class="pt-5">
        <div class="mb-4 flex flex-col gap-2 md:flex-row md:items-center">
            <div class="panel bg-gradient-to-r from-cyan-500 to-cyan-400 flex-1 small_card">
                <div class="text-md font-semibold" (click)="filterData(0)">Total Customers</div>
                <div class="mt-3 text-3xl font-bold">{{ total_row }}</div>
            </div>
            <div class="panel bg-gradient-to-r from-green-500 to-green-400 flex-1 small_card">
                <div class="text-md font-semibold" (click)="filterData(1)">Attemped & Converted </div>
                <div class="mt-3 text-3xl font-bold">{{ attempted_converted_count }}</div>
            </div>
            <div class="panel bg-gradient-to-r from-green-500 to-green-400 flex-1 small_card">
                <div class="text-md font-semibold" (click)="filterData(2)">Non-Attempted Converted </div>
                <div class="mt-3 text-3xl font-bold">{{ nonattempted_converted_count }}</div>
            </div>
            <div class="panel bg-gradient-to-r from-yellow-500 to-yellow-400 flex-1 small_card">
                <div class="text-md font-semibold" (click)="filterData(3)">Not Yet Converted </div>
                <div class="mt-3 text-3xl font-bold">{{ not_converted_count }}</div>
            </div>
            <div class="panel bg-gradient-to-r from-blue-500 to-blue-400 flex-1 small_card">
                <div class="text-md font-semibold" (click)="filterData(4)">Attempted Calls</div>
                <div class="mt-3 text-3xl font-bold">{{ attempted_call }}</div>
            </div>
            <div class="panel bg-gradient-to-r from-red-500 to-red-400 flex-1 small_card">
                <div class="text-md font-semibold" (click)="filterData(5)">Not Attempted Calls</div>
                <div class="mt-3 text-3xl font-bold">{{ not_attempted_call }}</div>
            </div>
        </div>
    </div>
    <div class="panel mt-6 pb-0">
        <div class="mb-5 flex flex-col gap-5 md:flex-row md:items-center" style="justify-content: center;">
            <h6 class="mb-5 text-lg font-bold">Assigned Lost Customers Details ({{start_date}} - {{due_date}})</h6>
            <div class="flex items-center gap-5 ltr:ml-auto rtl:mr-auto">
                <div hlMenu class="dropdown">
                    <button hlMenuButton type="button"
                        class="flex items-center rounded-md border border-[#e0e6ed] px-4 py-2 text-sm font-semibold dark:border-[#253b5c] dark:bg-[#1b2e4b] dark:text-white-dark">
                        <span class="ltr:mr-1 rtl:ml-1">Columns</span>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                            class="h-5 w-5">
                            <path d="M19 9L12 15L5 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                    </button>
                    <ul *hlMenuItems @toggleAnimation class="w-max ltr:left-0 rtl:right-0" style="z-index: 100">
                        <ng-container *ngFor="let col of cols; index as i">
                            <li>
                                <div class="flex items-center px-4 py-1">
                                    <label [for]="'chk-' + i" class="mb-0 cursor-pointer">
                                        <input type="checkbox" [id]="'chk-' + i" class="form-checkbox"
                                            [(ngModel)]="!col.hide" (change)="updateColumn(col)" />
                                        <span class="ltr:ml-2 rtl:mr-2">{{ col.title }}</span>
                                    </label>
                                </div>
                            </li>
                        </ng-container>
                    </ul>
                </div>
                <input [(ngModel)]="search" type="text" class="form-input w-auto" placeholder="Common Search" />

            </div>
        </div>
        <div class="datatable" *ngIf="!load_flag">
            <ng-datatable [rows]="custlist" [columns]="cols" [search]="search" [sortable]="true"
                skin="whitespace-nowrap table-hover bh-table-compact"
                firstArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                lastArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg> '
                previousArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                nextArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'>
                <ng-template slot="phone" let-value="data">
                    <button type="button" (click)="openCallLogs(value.phone)" class="btn btn-outline-secondary btn-sm"
                        ngxTippy="{{ value.phone }}" [tippyProps]="{ theme: 'info' }">
                        ****{{ value.phone | slice : -6 }}
                    </button>
                </ng-template>
                <!-- <ng-template slot="Action" let-value="data">
                    <button type="button" class="btn btn-outline-primary" ngxTippy="Call Update"
                        (click)="update(value.psfm_id)">Update</button>
                </ng-template> -->
                <ng-template slot="customer_name" let-value="data">
                    <strong class="text-info">{{ value.customer_name | titlecase }}</strong>
                </ng-template>
                <ng-template slot="lcst_note" let-value="data">
                    <button type="button" class="btn btn-outline-primary" ngxTippy="Call Update"
                        *ngIf="value.lcst_note == null"
                        (click)="assignedlostupdateModal(value.lcst_id,value.phone,value.customer_code,value.invoice_date,value.reg_no)">Update</button>
                    <p *ngIf="value.lcst_note && value.lcst_note.length>30" style="text-transform: capitalize;"
                        ngxTippy="{{value.lcst_note}}"> {{ value.lcst_note | slice:0:30 }}...</p>
                    <p *ngIf="value.lcst_note && value.lcst_note.length<=30 && value.lcst_note != null"
                        style="text-transform: capitalize;"> {{ value.lcst_note }}</p>
                </ng-template>

                <ng-template slot="Categorized" let-value="data">
                    <span class="badge bg-info" *ngIf="value.Categorized == 'Not Categorized'">Not Attempted</span>
                    <span class="badge bg-success" *ngIf="value.Categorized == 'Interested Customer'">Interested
                        Customer</span>
                    <span class="badge bg-warning" *ngIf="value.Categorized == 'Unhappy Customer'">Unhappy
                        Customer</span>
                    <span class="badge bg-secondary" *ngIf="value.Categorized == 'Non Contactable Customer'">Non
                        Contactable Customer</span>
                    <span class="badge bg-danger" *ngIf="value.Categorized == 'DND Customer (Do Not Disturb)'">DND
                        Customer (Do Not Disturb)</span>
                    <span class="badge bg-danger" *ngIf="value.Categorized == 'Lost Customer'">Lost Customer</span>
                </ng-template>
                <ng-template slot="lcst_status" let-value="data">
                    <span class="badge badge-outline-success"
                        *ngIf="value.lcst_status == 'Appointment'">Appointment</span>
                    <span class="badge badge-outline-success" *ngIf="value.lcst_status == 'Positive Response'">Positive
                        Response</span>
                    <span class="badge badge-outline-warning" *ngIf="value.lcst_status == 'Not Answered'">Not
                        Answered</span>
                    <span class="badge badge-outline-secondary" *ngIf="value.lcst_status == 'Visited Customer'">Visited
                        Customer</span>
                    <span class="badge badge-outline-danger" *ngIf="value.lcst_status == 'Unhappy Customer'">Unhappy
                        Customer</span>
                    <span class="badge badge-outline-danger" *ngIf="value.lcst_status == 'Car Sold'">Car Sold</span>
                    <span class="badge badge-outline-primary" *ngIf="value.lcst_status == 'Answered'">Answered</span>
                </ng-template>
                <!-- <ng-template slot="psf_status" let-value="data">
                    <span  class="badge bg-primary"   *ngIf="value.psf_status == 'Open'">Open</span>
                    <span class="badge bg-warning" *ngIf="value.psf_status == 'Pending'">Pending</span>
                    <span class="badge bg-success" *ngIf="value.psf_status == 'Completed'">Completed</span>
                </ng-template> -->

            </ng-datatable>
        </div>
        <div *ngIf="load_flag" style="text-align: center">
            <span
                class="m-auto mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"></span>
        </div>
    </div>
</div>
<modal #assignedlostupdate class="modal-top animate animate-slide-in-down extra-large-modal call-view"
    [closeOnOutsideClick]="false" style="max-width: 90vw;">
    <ng-template #modalHeader>
        <div style=" align-items: center; display: flex; ">
            CUSTOMER INFO-({{cust_phone}})
        </div>
    </ng-template>
    <ng-template #modalBody>
        <app-assigned-lost-update [assignedLostData]="assignedLostData"
            (modalEvent)="assignedlostupdateModalClose()"></app-assigned-lost-update>
    </ng-template>
    <!-- <ng-template #modalFooter>
       <button type="button" (click)="assignedlostupdateModalClose()" class="btn btn-outline-danger">DISMISS</button>
   </ng-template> -->
</modal>
<modal #calllogmodal class="modal-top animate animate-slide-in-down extra-large-modal call-view"
    [closeOnOutsideClick]="false" style="max-width: 90vw;">
    <ng-template #modalHeader>
        <div style=" align-items: center; display: flex; ">
            Recent Call Logs
        </div>
    </ng-template>
    <ng-template #modalBody>
        <app-call-log-detail [calllogphn]="calllogphn"></app-call-log-detail>
    </ng-template>
    <ng-template #modalFooter>
        <button type="button" (click)="callhistoryModal()" class="btn btn-outline-danger">DISMISS</button>
    </ng-template>
</modal>