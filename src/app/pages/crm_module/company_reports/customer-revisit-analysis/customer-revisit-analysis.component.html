<ol class="flex font-semibold text-primary dark:text-white-dark">
    <li class="bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]">
        <a
            routerLink="/dashboard"
            class="relative flex h-full items-center p-1.5 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-3 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-3 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70"
            >Home</a
        >
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180"
            >MIS</a
        >
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            routerLink=""
            class="relative flex h-full items-center p-1.5 px-3 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-6 ltr:before:-right-[15px] rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70"
            >Lost Customer Win</a
        >
    </li>
</ol>
<div class="mb-5">
    <div class="mt-3 flex flex-wrap border-b border-white-light dark:border-[#191e3a]">
        <a
            href="javascript:;"
            class="-mb-[1px] flex items-center border border-transparent p-3.5 py-2 !outline-none transition duration-300 hover:text-danger"
            [ngClass]="{ '!border-white-light !border-b-white text-danger dark:!border-[#191e3a] dark:!border-b-black': tab.toLowerCase() === 'rrvanalysis' }"
            (click)="tab = 'rrvAnalysis'"
        >
            <!-- <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ltr:mr-2 rtl:ml-2">
                <path
                    opacity="0.5"
                    d="M2 12.2039C2 9.91549 2 8.77128 2.5192 7.82274C3.0384 6.87421 3.98695 6.28551 5.88403 5.10813L7.88403 3.86687C9.88939 2.62229 10.8921 2 12 2C13.1079 2 14.1106 2.62229 16.116 3.86687L18.116 5.10812C20.0131 6.28551 20.9616 6.87421 21.4808 7.82274C22 8.77128 22 9.91549 22 12.2039V13.725C22 17.6258 22 19.5763 20.8284 20.7881C19.6569 22 17.7712 22 14 22H10C6.22876 22 4.34315 22 3.17157 20.7881C2 19.5763 2 17.6258 2 13.725V12.2039Z"
                    stroke="currentColor"
                    stroke-width="1.5"
                />
                <path d="M12 15L12 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg> -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 me-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
              </svg>
              
            Customer Revisit Analysis
        </a>
        <a
        href="javascript:;"
        class="-mb-[1px] flex items-center border border-transparent p-3.5 py-2 !outline-none transition duration-300 hover:text-danger"
        [ngClass]="{ '!border-white-light !border-b-white text-danger dark:!border-[#191e3a] dark:!border-b-black': tab.toLowerCase() === 'rrv' }"
        (click)="tab = 'rrv'"
    >
        <!-- <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ltr:mr-2 rtl:ml-2">
            <path
                opacity="0.5"
                d="M2 12.2039C2 9.91549 2 8.77128 2.5192 7.82274C3.0384 6.87421 3.98695 6.28551 5.88403 5.10813L7.88403 3.86687C9.88939 2.62229 10.8921 2 12 2C13.1079 2 14.1106 2.62229 16.116 3.86687L18.116 5.10812C20.0131 6.28551 20.9616 6.87421 21.4808 7.82274C22 8.77128 22 9.91549 22 12.2039V13.725C22 17.6258 22 19.5763 20.8284 20.7881C19.6569 22 17.7712 22 14 22H10C6.22876 22 4.34315 22 3.17157 20.7881C2 19.5763 2 17.6258 2 13.725V12.2039Z"
                stroke="currentColor"
                stroke-width="1.5"
            />
            <path d="M12 15L12 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
        </svg> -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 me-2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
          </svg>
          
        Revisited Customer
    </a>
        </div>
    <div class="flex-1">
        <div *ngIf="tab.toLowerCase() === 'rrvanalysis'">
            <div class="panel pb-0">
                <div class="mb-5 flex flex-col gap-5 md:flex-row md:items-center">
                    <h5 class="text-lg font-semibold dark:text-white-light">Customer Revisit Analysis</h5>
                    <div class="flex items-center gap-5 ltr:ml-auto rtl:mr-auto">
                        <div>
                        <input [(ngModel)]="start_date"  type="date" class="form-input text-xs" placeholder="Date From " [min]="minDate" />
                        </div>
            
                        <div>
                        <input type="date" placeholder="Date To" [(ngModel)]="end_date" class="form-input text-xs" />
                        </div>
            
                        <div class="flex flex-row items-end">
                            <button type="button" class="btn btn-success btn-sm" style="float: right" (click)="getJobCardsData()">SEARCH</button>
                        </div>
                        
                    </div>
                    <hr class="my-6 border-[#e0e6ed] dark:border-[#1b2e4b]" />
                </div>
            
                <div *ngIf="!load_flag" class="flex justify-start items-center gap-4" 
                
                >
                    <div class="flex justify-center items-center"><h1>Gap Days</h1></div>
                   
                    <div class="flex items-center">
                        <ng-select class="w-[12rem]"   [(ngModel)]="filter_num_selcetd" [items]="filterOptions" bindLabel="name" bindValue="id" >
                            <!-- <ng-option value="0">Filter</ng-option> -->
                            <ng-option value="1">Equal To</ng-option>
                            <ng-option value="2">Greater than</ng-option>
                            <ng-option value="3">Less Than</ng-option>
                            <ng-option value="4">Between</ng-option>
                        </ng-select>
                    </div>
                    <div class="flex flex-row justify-center"><input [(ngModel)]="filter_value_1" class="w-[10rem] form-input text-xs" placeholder="{{filter_num_selcetd == 4?'From':'Enter Gap Days'}}" type="text"></div>
                    <div class="flex flex-row justify-center" ><input *ngIf="filter_num_selcetd == 4" [(ngModel)]="filter_value_2" class="w-[10rem] form-input text-xs" placeholder="To" type="text"></div>
                   <div class="flex items-center justify-center"><button class="btn btn-success btn-sm" (click)="filtergapDays()">SEARCH</button></div>
                
                </div>
            
                <div *ngIf="load_flag || loadflag_prev_year" style="text-align: center">
                    <span
                        class="m-auto mt-10 mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"
                    ></span>
                </div>

                <div *ngIf="!load_flag">
                    <div class="flex flex-wrap items-center justify-center gap-3">
                        <button type="button" class="btn btn-success my-4"
                        [ngStyle]="{opacity:selected==-1?'100%':'70%'}" (click)="filterJobData(-1)">
                        Total JobCards<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4"
                            style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;">{{totalCount.totalJobs}}</span>
                    </button>
                        <button type="button" class="btn btn-primary my-4" [ngStyle]="{opacity:selected==0?'100%':'70%'}" (click)="filterJobData(0)">
                            Total Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4" style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;" >{{totalCount.totalCustomers}}</span>
                        </button>
                
                        <button  type="button" class="btn btn-secondary my-4" [ngStyle]="{opacity:selected==1?'100%':'70%'}" (click)="filterJobData(1)">
                            New Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4" style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;" >{{totalCount.newCustomers}}</span>
                        </button>
                
                        <button type="button" class="btn btn-warning my-4" [ngStyle]="{opacity:selected==2?'100%':'70%'}" (click)="filterJobData(2)">
                            Regular Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4" style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;" >{{totalCount.regularCustomers}}</span>
                        </button>
                        <button type="button" class="btn btn-danger my-4" [ngStyle]="{opacity:selected==3?'100%':'70%'}" (click)="filterJobData(3)">
                            Lost Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4" style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;"  >{{totalCount.lostCustomers}}</span>
                        </button>
                    </div>
            
                    <h3 *ngIf="!loadflag_prev_year" class="text-center text-xl">Previous Year Reports</h3>
            
                    <div *ngIf="!loadflag_prev_year" class="flex flex-wrap items-center justify-center gap-3">
                        <button disabled type="button" class="btn btn-outline-success my-4">
                            Total Job Cards<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4"
                                style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;">{{prevtotalCount.totalJobs}}</span>
                        </button>
                        <button disabled type="button" class="btn btn-outline-primary my-4">
                            Total Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4"
                                style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;">{{prevtotalCount.totalCustomers}}</span>
                        </button>

                        <button disabled type="button" class="btn btn-outline-secondary my-4">
                            New Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4"
                                style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;">{{prevtotalCount.newCustomers}}</span>
                        </button>

                        <button disabled type="button" class="btn btn-outline-warning my-4">
                            Regular Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4"
                                style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;">{{prevtotalCount.regularCustomers}}</span>
                        </button>
                        <button disabled type="button" class="btn btn-outline-danger my-4">
                            Lost Customers<span class="badge my-0 bg-white-light text-black ltr:ml-4 rtl:mr-4"
                                style="font-size: 20px; font-weight: 700;padding-top: 0.4rem;padding-bottom: 0.4rem;">{{prevtotalCount.lostCustomers}}</span>
                        </button>
                    </div>
            
                    <ng-datatable
                            [rows]="jobData"
                            [columns]="cols"
                            [search]="search"
                            [columnFilter]="true"
                            skin="whitespace-nowrap table-hover bh-table-compact"
                            firstArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                            lastArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg> '
                            previousArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                            nextArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                        >
                            <ng-template slot="cust_type" let-value="data">
                                <button type="button" *ngIf="value.cust_type=='Lost Customer'" class="btn btn-outline-warning btn-sm">{{ value.cust_type }}</button>
                                <button type="button" *ngIf="value.cust_type=='Retained Customer'" class="btn btn-outline-success btn-sm">{{ value.cust_type }}</button>
                                <button type="button" *ngIf="value.cust_type=='New Customer'" class="btn btn-outline-primary btn-sm">{{ value.cust_type }}</button>
                            </ng-template>
                        </ng-datatable>
                </div>
            </div> 
        </div>
        <div *ngIf="tab.toLowerCase() === 'rrv'">
            <div class="flex items-start">
                <div class="h-20 w-20 flex-none ltr:mr-4 rtl:ml-4">
                    <img
                        src="/assets/images/profile-34.jpeg"
                        alt=""
                        class="m-0 h-20 w-20 rounded-full object-cover ring-2 ring-[#ebedf2] dark:ring-white-dark"
                    />
                </div>
                <div class="flex-auto">
                    <h5 class="mb-4 text-xl font-medium">Media heading</h5>
                    <p class="text-white-dark">
                        Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum
                        in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis
                        in faucibus.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
 
