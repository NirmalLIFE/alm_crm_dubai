<ol class="flex font-semibold text-primary dark:text-white-dark">
    <li class="bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]">
        <a routerLink="/dashboard"
            class="relative flex h-full items-center p-1.5 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-3 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-3 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">Home</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180">
            MIS</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center p-1.5 px-3 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-6 ltr:before:-right-[15px] rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">
            Missed Call Report</a>
    </li>
</ol>
<div class="panel pt-5 mt-5">
    <h5 class=" mb-5 ng-tns-c35-16 text-lg font-semibold dark:text-white-light "><b>Missed Call Report</b></h5>
    <div class="mb-5 grid flex-1 grid-cols-2 gap-2 lg:grid-cols-3 xl:grid-cols-4">
        <div>
            <label for="name" class="small_label_text m-0 dark:text-white-dark">Start Date</label>
            <input type="date" [(ngModel)]="start_date" class="form-input" ngxTippy="Start Date"
                placeholder="Start Date From" />
        </div>
        <div>
            <label for="name" class="small_label_text m-0 dark:text-white-dark">End Date</label>
            <input type="date" [(ngModel)]="end_date" class="form-input" ngxTippy="End Date"
                placeholder="End Date From" />
        </div>
        <div>
            <label for="name" class="small_label_text m-0 dark:text-white-dark" style="color: white;">.</label>
            <button type="button" class="btn btn-outline-primary" (click)="getCalls()">SEARCH</button>
        </div>
    </div>
    <div *ngIf="load_flag" style="text-align: center">
        <span
            class="m-auto mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"></span>
    </div>
    <div *ngIf="!load_flag">


        <div class="container">
            <div class="mb-5 grid flex-1 grid-cols-3 gap-2 lg:grid-cols-3 xl:grid-cols-3 ">
                <div></div>
                <div class="panel flex" style="background: linear-gradient(to right, #258EA6, #258EA6); cursor: pointer"
                    (click)="cardFilter('TOTALCALL')" [ngClass]="{'selectedcard': selectedCard == 'TOTALCALL'}">
                    <div class="text-md font-semibold">TOTAL MISS CALLS</div>
                    <div class="mt-3 text-3xl font-bold">{{ totalcall }}</div>
                </div>
            </div>


            <!--start-->

            <div class="mb-3 grid grid-cols-2 gap-2 md:grid-cols-2 lg:grid-cols-2 panel">
                <div class="panel h-full" style="background:linear-gradient(to right,#182848, #4b6cb7) ;"
                    [ngClass]="{'selectedcard': selectedCard == 'WTMISS'}">
                    <div class="-m-5 mb-2 flex items-center justify-between border-b border-[#e0e6ed] dark:border-[#1b2e4b]"
                        style="padding: 0.75rem 1.25rem 0.75rem 1.25rem;">
                        <a href="javascript:;" class="flex font-semibold" (click)="cardFilter('WTMISS')">
                            <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-md bg-white ltr:mr-4 rtl:ml-4"
                                style="font-weight: 800;font-size: 22px;">
                                <span>{{ wtCn }}</span>
                            </div>
                            <div>
                                <h6 class="text-white-light" style="margin: 0;">WORKTIME MISSED CALLS</h6>

                            </div>
                        </a>
                    </div>
                    <div class="grid grid-cols-2 gap-2 md:grid-cols-2 md:items-center lg:grid-cols-2 mb-5">
                        <div class="panel flex" [ngClass]="{'selectedcard': selectedCard == 'WTEXTCUSMISS' || selectedCard == 'WTEXTCUSCBMISS' || selectedCard == 'WTEXTCUSAPMISS'
                     } " style="background: linear-gradient(to right, #8addf0, #9be3f0); cursor: pointer">
                            <div class="row">
                                <div class="-m-5 mb-2 flex items-center justify-between"
                                    style="padding: 0.75rem 1.25rem 0.75rem 1.25rem;">
                                    <a href="javascript:;" class="flex font-semibold"
                                        (click)="cardFilter('WTEXTCUSMISS')">
                                        <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-md bg-white ltr:mr-4 rtl:ml-4"
                                            style="font-weight: 800;font-size: 22px;">
                                            <span>{{ wtCne }}</span>
                                        </div>
                                        <div>
                                            <h6 style="margin: 0;">Existing Customer</h6>

                                        </div>
                                    </a>
                                </div>
                                <div class="group">
                                    <p (click)="cardFilter('WTEXTCUSCBMISS')"
                                        [ngClass]="{'selected': selectedCard == 'WTEXTCUSCBMISS'}">Total Callback
                                        -{{wtCnCbe}}
                                    </p>
                                    <p (click)="cardFilter('WTEXTCUSAPMISS')"
                                        [ngClass]="{'selected': selectedCard == 'WTEXTCUSAPMISS'}">Action Pending-{{
                                        wtCnApe }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="panel flex"
                            [ngClass]="{'selectedcard': selectedCard == 'WTNEWCUSMISS' || selectedCard == 'WTNEWCUSCBMISS' || selectedCard == 'WTNEWCUSAPMISS' }"
                            style="background: linear-gradient(to right, #7d8bdc, #6f84d6); cursor: pointer">
                            <div class="row">
                                <div class="-m-5 mb-2 flex items-center justify-between"
                                    style="padding: 0.75rem 1.25rem 0.75rem 1.25rem;">
                                    <a href="javascript:;" class="flex font-semibold"
                                        (click)="cardFilter('WTNEWCUSMISS')">
                                        <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-md bg-white ltr:mr-4 rtl:ml-4"
                                            style="font-weight: 800;font-size: 22px;">
                                            <span>{{ wtCnn }}</span>
                                        </div>
                                        <div>
                                            <h6 style="margin: 0;">New Customer</h6>

                                        </div>
                                    </a>
                                </div>
                                <div class="group">
                                    <p (click)="cardFilter('WTNEWCUSCBMISS')"
                                        [ngClass]="{'selected': selectedCard == 'WTNEWCUSCBMISS'}"> Total Callback -{{
                                        wtCnCbn }}
                                    </p>
                                    <p (click)="cardFilter('WTNEWCUSAPMISS')"
                                        [ngClass]="{'selected': selectedCard == 'WTNEWCUSAPMISS'}">Action Pending- {{
                                        wtCnApn }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel h-full" style="background:linear-gradient(to right,#182848, #4b6cb7) ;"
                    [ngClass]="{'selectedcard': selectedCard == 'NWTMISS'}">
                    <div class="-m-5 mb-2 flex items-center justify-between border-b border-[#e0e6ed] dark:border-[#1b2e4b]"
                        style="padding: 0.75rem 1.25rem 0.75rem 1.25rem;">
                        <a href="javascript:;" class="flex font-semibold" (click)="cardFilter('NWTMISS')">
                            <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-md bg-white ltr:mr-4 rtl:ml-4"
                                style="font-weight: 800;font-size: 22px;">
                                <span>{{ nwtCn }}</span>
                            </div>
                            <div>
                                <h6 class="text-white-light" style="margin: 0;">NON WORKTIME MISSED CALLS</h6>

                            </div>
                        </a>
                    </div>



                    <div class="grid grid-cols-2 gap-2 md:grid-cols-2 md:items-center lg:grid-cols-2 mb-5">



                        <div class="panel flex"
                            [ngClass]="{'selectedcard': selectedCard == 'NWTEXTCUSMISS' || selectedCard == 'NWTEXTCUSCBMISS' || selectedCard == 'NWTEXTCUSAPMISS'}"
                            style="background: linear-gradient(to right, #8addf0, #9be3f0); cursor: pointer">
                            <div class="row">
                                <div class="-m-5 mb-2 flex items-center justify-between"
                                    style="padding: 0.75rem 1.25rem 0.75rem 1.25rem;">
                                    <a href="javascript:;" class="flex font-semibold"
                                        (click)="cardFilter('NWTEXTCUSMISS')">
                                        <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-md bg-white ltr:mr-4 rtl:ml-4"
                                            style="font-weight: 800;font-size: 22px;">
                                            <span>{{ nwtCne }}</span>
                                        </div>
                                        <div>
                                            <h6 style="margin: 0;">Existing Customer</h6>

                                        </div>
                                    </a>
                                </div>
                                <div class="group">
                                    <p (click)="cardFilter('NWTEXTCUSCBMISS')"
                                        [ngClass]="{'selected': selectedCard == 'NWTEXTCUSCBMISS'}">Total Callback -{{
                                        nwtCnCbe }}
                                    </p>
                                    <p (click)="cardFilter('NWTEXTCUSAPMISS')"
                                        [ngClass]="{'selected': selectedCard == 'NWTEXTCUSAPMISS'}">Action Pending-{{
                                        nwtCnApe }}</p>
                                </div>
                            </div>




                        </div>
                        <div class="panel flex"
                            [ngClass]="{'selectedcard': selectedCard == 'NWTNEWCUSMISS' || selectedCard == 'NWTNEWCUSCBMISS' || selectedCard == 'NWTNEWCUSAPMISS' }"
                            style="background: linear-gradient(to right, #7d8bdc, #6f84d6); cursor: pointer">

                            <!--start inner Card Data-->

                            <div class="row">
                                <div class="-m-5 mb-2 flex items-center justify-between"
                                    style="padding: 0.75rem 1.25rem 0.75rem 1.25rem;">
                                    <a href="javascript:;" class="flex font-semibold"
                                        (click)="cardFilter('NWTNEWCUSMISS')">
                                        <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-md bg-white ltr:mr-4 rtl:ml-4"
                                            style="font-weight: 800;font-size: 22px;">
                                            <span>{{ nwtCnn }}</span>
                                        </div>
                                        <div>
                                            <h6 style="margin: 0;">New Customer</h6>

                                        </div>
                                    </a>
                                </div>
                                <div class="group">
                                    <p (click)="cardFilter('NWTNEWCUSCBMISS')"
                                        [ngClass]="{'selected': selectedCard == 'NWTNEWCUSCBMISS'}">Total Callback-{{
                                        nwtCnCbn }}</p>
                                    <p (click)="cardFilter('NWTNEWCUSAPMISS')"
                                        [ngClass]="{'selected': selectedCard == 'NWTNEWCUSAPMISS'}">Action Pending-{{
                                        nwtCnApn }}</p>
                                </div>
                            </div>

                            <!--end inner Card Data-->

                        </div>
                    </div>



                </div>
            </div>
            <!--end-->

        </div>




        <!-- <div class="grid grid-cols-1 gap-4 md:grid-cols-4 md:items-center lg:grid-cols-6 mb-5">
            <div class="panel flex" style="background: linear-gradient(to right, #258EA6, #258EA6); cursor: pointer"
                (click)="cardFilter('TOTALCALL')">
                <div class="text-md font-semibold">TOTAL MISS CALLS</div>
                <div class="mt-3 text-3xl font-bold">{{ totalcall }}</div>
            </div>
            <div class="panel flex" style="background: linear-gradient(to right, #549F93, #549F93); cursor: pointer"
                (click)="cardFilter('WTMISS')">
                <div class="text-md font-semibold">WORKTIME MISSED CALLS</div>
                <div class="mt-3 text-3xl font-bold">{{ wtCn }}</div>
            </div>
            <div class="panel flex" style="background: linear-gradient(to right, #9FAF90, #9FAF90); cursor: pointer"
                (click)="cardFilter('NWTMISS')">
                <div class="text-md font-semibold">NON WORKTIME MISSED CALLS</div>
                <div class="mt-3 text-3xl font-bold"> {{ nwtCn }}</div>
            </div>
            <div class="panel flex" style="background: linear-gradient(to right, #E2B1B1, #E2B1B1); cursor: pointer"
                (click)="cardFilter('CALLBACK')">
                <div class="text-md font-semibold">TOTAL CALLBACK</div>
                <div class="mt-3 text-3xl font-bold">{{ cbCn }}</div>
            </div>
            <div class="panel flex" style="background: linear-gradient(to right, #748CAB, #748CAB); cursor: pointer"
                (click)="cardFilter('EXTCUS')">
                <div class="text-md font-semibold">EXISTING CUSTOMERS</div>
                <div class="mt-3 text-3xl font-bold"> {{ excall }}</div>
            </div>
            <div class="panel bg-gradient-to-r from-gray-500 to-gray-400 flex" style="cursor: pointer"
                (click)="cardFilter('NEWCUS')">
                <div class="text-md font-semibold">NEW CUSTOMERS</div>
                <div class="mt-3 text-3xl font-bold"> {{ necall }}</div>
            </div>
        </div> -->
        <div class="mb-5 flex flex-col gap-5 md:flex-row md:items-center">
            <div class="flex items-center gap-5 ltr:ml-auto rtl:mr-auto">
                <input [(ngModel)]="search" type="text" class="form-input w-auto" placeholder="Search..." />
            </div>
        </div>
        <div class="datatable">
            <ng-datatable [rows]="report" [columns]="cols" [search]="search" [sortable]="true" [columnFilter]="false"
                skin="whitespace-nowrap table-hover bh-table-compact"
                firstArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                lastArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg> '
                previousArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                nextArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'>
                <ng-template slot="action" let-value="data">
                    <button type="button" ngxTippy="View Call Details" (click)="ViewDetails(value.src)"
                        class="btn btn-primary btn-sm h-6 w-6 rounded-full p-0">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M15.3929 4.05365L14.8912 4.61112L15.3929 4.05365ZM19.3517 7.61654L18.85 8.17402L19.3517 7.61654ZM21.654 10.1541L20.9689 10.4592V10.4592L21.654 10.1541ZM3.17157 20.8284L3.7019 20.2981H3.7019L3.17157 20.8284ZM20.8284 20.8284L20.2981 20.2981L20.2981 20.2981L20.8284 20.8284ZM14 21.25H10V22.75H14V21.25ZM2.75 14V10H1.25V14H2.75ZM21.25 13.5629V14H22.75V13.5629H21.25ZM14.8912 4.61112L18.85 8.17402L19.8534 7.05907L15.8947 3.49618L14.8912 4.61112ZM22.75 13.5629C22.75 11.8745 22.7651 10.8055 22.3391 9.84897L20.9689 10.4592C21.2349 11.0565 21.25 11.742 21.25 13.5629H22.75ZM18.85 8.17402C20.2034 9.3921 20.7029 9.86199 20.9689 10.4592L22.3391 9.84897C21.9131 8.89241 21.1084 8.18853 19.8534 7.05907L18.85 8.17402ZM10.0298 2.75C11.6116 2.75 12.2085 2.76158 12.7405 2.96573L13.2779 1.5653C12.4261 1.23842 11.498 1.25 10.0298 1.25V2.75ZM15.8947 3.49618C14.8087 2.51878 14.1297 1.89214 13.2779 1.5653L12.7405 2.96573C13.2727 3.16993 13.7215 3.55836 14.8912 4.61112L15.8947 3.49618ZM10 21.25C8.09318 21.25 6.73851 21.2484 5.71085 21.1102C4.70476 20.975 4.12511 20.7213 3.7019 20.2981L2.64124 21.3588C3.38961 22.1071 4.33855 22.4392 5.51098 22.5969C6.66182 22.7516 8.13558 22.75 10 22.75V21.25ZM1.25 14C1.25 15.8644 1.24841 17.3382 1.40313 18.489C1.56076 19.6614 1.89288 20.6104 2.64124 21.3588L3.7019 20.2981C3.27869 19.8749 3.02502 19.2952 2.88976 18.2892C2.75159 17.2615 2.75 15.9068 2.75 14H1.25ZM14 22.75C15.8644 22.75 17.3382 22.7516 18.489 22.5969C19.6614 22.4392 20.6104 22.1071 21.3588 21.3588L20.2981 20.2981C19.8749 20.7213 19.2952 20.975 18.2892 21.1102C17.2615 21.2484 15.9068 21.25 14 21.25V22.75ZM21.25 14C21.25 15.9068 21.2484 17.2615 21.1102 18.2892C20.975 19.2952 20.7213 19.8749 20.2981 20.2981L21.3588 21.3588C22.1071 20.6104 22.4392 19.6614 22.5969 18.489C22.7516 17.3382 22.75 15.8644 22.75 14H21.25ZM2.75 10C2.75 8.09318 2.75159 6.73851 2.88976 5.71085C3.02502 4.70476 3.27869 4.12511 3.7019 3.7019L2.64124 2.64124C1.89288 3.38961 1.56076 4.33855 1.40313 5.51098C1.24841 6.66182 1.25 8.13558 1.25 10H2.75ZM10.0298 1.25C8.15538 1.25 6.67442 1.24842 5.51887 1.40307C4.34232 1.56054 3.39019 1.8923 2.64124 2.64124L3.7019 3.7019C4.12453 3.27928 4.70596 3.02525 5.71785 2.88982C6.75075 2.75158 8.11311 2.75 10.0298 2.75V1.25Z"
                                fill="#fff" />
                            <path d="M6 14.5H14" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                            <path d="M6 18H11.5" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                            <path d="M13 2.5V5C13 7.35702 13 8.53553 13.7322 9.26777C14.4645 10 15.643 10 18 10H22"
                                stroke="#fff" stroke-width="1.5" />
                        </svg>
                        <!-- <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none">
                            <path
                                d="M18.18 8.03933L18.6435 7.57589C19.4113 6.80804 20.6563 6.80804 21.4241 7.57589C22.192 8.34374 22.192 9.58868 21.4241 10.3565L20.9607 10.82M18.18 8.03933C18.18 8.03933 18.238 9.02414 19.1069 9.89309C19.9759 10.762 20.9607 10.82 20.9607 10.82M18.18 8.03933L13.9194 12.2999C13.6308 12.5885 13.4865 12.7328 13.3624 12.8919C13.2161 13.0796 13.0906 13.2827 12.9882 13.4975C12.9014 13.6797 12.8368 13.8732 12.7078 14.2604L12.2946 15.5L12.1609 15.901M20.9607 10.82L16.7001 15.0806C16.4115 15.3692 16.2672 15.5135 16.1081 15.6376C15.9204 15.7839 15.7173 15.9094 15.5025 16.0118C15.3203 16.0986 15.1268 16.1632 14.7396 16.2922L13.5 16.7054L13.099 16.8391M13.099 16.8391L12.6979 16.9728C12.5074 17.0363 12.2973 16.9867 12.1553 16.8447C12.0133 16.7027 11.9637 16.4926 12.0272 16.3021L12.1609 15.901M13.099 16.8391L12.1609 15.901"
                                stroke="#fff" stroke-width="1.5" />
                            <path d="M8 13H10.5" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                            <path d="M8 9H14.5" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                            <path d="M8 17H9.5" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                            <path
                                d="M19.8284 3.17157C18.6569 2 16.7712 2 13 2H11C7.22876 2 5.34315 2 4.17157 3.17157C3 4.34315 3 6.22876 3 10V14C3 17.7712 3 19.6569 4.17157 20.8284C5.34315 22 7.22876 22 11 22H13C16.7712 22 18.6569 22 19.8284 20.8284C20.7715 19.8853 20.9554 18.4796 20.9913 16"
                                stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                        </svg> -->
                    </button>
                </ng-template>
                <ng-template slot="customer" let-value="data">
                    <span *ngIf="value.customer!='new' && value.customer!='EXISTS'"
                        style="text-transform: capitalize;cursor: pointer;" class="text-success">
                        {{ value.customer }}</span>
                    <span *ngIf="value.customer=='new' || value.customer =='EXISTS'" style="text-transform: capitalize"
                        class="text-success">
                        {{ value.customer }}</span>
                </ng-template>
                <ng-template slot="Callback" let-value="data">
                    <span *ngIf="(value.callarr && value.callarr.length > 0 && 
                        value.callarr[value.callarr.length - 1].username =='Inbound' && 
                        value.call_back == 'fail')" class="text-success"> <strong>Inbound Answered</strong></span>
                    <span *ngIf="(value.callarr && value.callarr.length == 0 && 
                        value.call_back == 'fail' )">
                        Didn't Call</span>
                    <span *ngIf="value.callarr && value.callarr.length > 0 && 
                        value.callarr[value.callarr.length - 1].username =='Callback' && 
                        value.call_back == 'fail' ">Late Call</span>
                    <span *ngIf="value.callarr && value.callarr.length > 0 && 
                            value.callarr[value.callarr.length - 1].username =='Inbound' && 
                            value.call_back == 'success' " class="text-success">Reinbound Call</span>
                    <span *ngIf="value.callarr && value.callarr.length > 0 && 
                                value.callarr[value.callarr.length - 1].username =='Callback' && 
                                value.call_back == 'success' " class="text-success">Callback</span>
                </ng-template>
                <ng-template slot="src" let-value="data">
                    <button type="button" class="btn btn-outline-secondary btn-sm" ngxTippy="{{ value.src }}"
                        [tippyProps]="{ theme: 'info' }">
                        ****{{ value.src | slice : -6 }}
                    </button>
                </ng-template>
                <ng-template slot="call_list" let-value="data">
                    <div style="border: 1px solid #00000085; border-radius: 15px; margin-top: 4px; text-align: center"
                        *ngIf="value.callarr && value.callarr.length > 0;">
                        <span style="display: inline-flex">
                            <p style="margin: 4px; font-size: 12px">{{ value.callarr[value.callarr.length - 1].datetime
                                }} -
                            </p>
                            <p style="margin: 4px; font-size: 14px"
                                *ngIf="value.callarr[value.callarr.length - 1].calltype=='Inbound'">
                                <b>{{ value.callarr[value.callarr.length - 1].dst }}</b>
                            </p>
                            <p style="margin: 4px; font-size: 14px"
                                *ngIf="value.callarr[value.callarr.length - 1].calltype!='Inbound'">
                                <b>{{ value.callarr[value.callarr.length - 1].src }}</b>
                            </p>
                        </span><br />
                        <span style="display: inline-flex">
                            <p *ngIf="value.disposition == 'NO ANSWER'"
                                style="margin-bottom: 0; font-size: 12px; font-weight: 700; color: red">
                                {{ value.callarr[value.callarr.length - 1].disposition }}
                            </p>
                            <p *ngIf="value.disposition != 'NO ANSWER'"
                                style="margin-bottom: 0; font-size: 12px; font-weight: 700">{{
                                value.callarr[value.callarr.length - 1].disposition }}</p>
                        </span>
                        <br />
                        <span style="font-size: 14px"
                            [ngClass]="{'text-success': value.callarr[value.callarr.length - 1].username === 'Callback'}">
                            <b>{{ value.callarr[value.callarr.length - 1].username }}</b>
                        </span>
                        <br />
                        <span *ngIf="value.leadlog == 'fail' && value.disposition == 'ANSWERED'"
                            style="font-size: 12px; color: red">
                            NIL
                        </span>
                        <span *ngIf="value.leadlog != 'fail'" style="font-size: 12px">
                            {{ value.leadlog }}
                        </span>
                    </div>
                    <div style="border: 1px solid #00000085; border-radius: 15px; margin-top: 4px; text-align: center"
                        *ngFor="let rowc of value.misscallarr;let i = index">
                        <span style="display: inline-flex" *ngIf="
                        rowc.calltype == 'Inbound' && rowc.disposition == 'NO ANSWER' ">
                            <b>Missed call</b>
                        </span>
                        <br />
                        <span style="display: inline-flex" *ngIf="
                        rowc.calltype == 'Inbound' || rowc.calltype == 'Outbound'">
                            <p style="margin: 4px; font-size: 12px">
                                {{ rowc.datetime }}
                            </p>
                        </span><br />
                        <span style="display: inline-flex" *ngIf="rowc.disposition == 'NO ANSWER'">
                            <p style="margin-bottom: 0; font-size: 12px; font-weight: 700; color: red">
                                {{ rowc.disposition }}
                            </p>
                        </span>
                        <br />
                    </div>
                </ng-template>
            </ng-datatable>
        </div>
    </div>

</div>

<modal #custDetailModal class="modal-top animate animate-slide-in-down extra-large-modal call-view"
    [closeOnOutsideClick]="false" style="max-width: 90vw;">
    <ng-template #modalHeader>
        <div style=" align-items: center; display: flex; ">
            Customer Details
        </div>
    </ng-template>
    <ng-template #modalBody>
        <div *ngIf="load_flag" style="text-align: center">
            <span
                class="m-auto mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"></span>
        </div>
        <div *ngIf="!load_flag">
            <div class="table-responsive" *ngIf="customerdata.length !='0'">
                <table class="small_view" style="border: 1px solid #eee">
                    <thead>
                        <tr>
                            <th style="width: 20%">Name</th>
                            <th style="width: 12%">Location</th>
                            <th>Latest Job-card</th>
                            <th style="width: 15%" class="text-center">Latest SA</th>
                            <th class="text-center">Last Invoiced</th>
                            <th style="width: 20%" class="text-center">Vehicles</th>
                            <th class="text-right">Total Job-cards</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <b>{{ customerdata.customer_name }}</b>
                            </td>
                            <td>{{ customerdata.city }}</td>
                            <td>
                                <span class="badge badge-outline-primary" *ngIf="custjobcard.length >0">{{
                                    custjobcard[0].job_no }}</span>
                            </td>
                            <td>
                                <b *ngIf="custjobcard.length >0">{{ custjobcard[0].user_name }}</b>
                            </td>
                            <td *ngIf="custjobcard.length >0">{{ custjobcard[0].invoice_date }}</td>
                            <td>
                                <span *ngFor="let veh of custvehicle">{{ veh.reg_no }}, </span>
                            </td>
                            <td class="text-right">{{ custjobcard.length }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- <hr class="my-2 dark:border-[#191e3a]" style="border: 1px solid #eee" />
            <div class="table-responsive" *ngIf="custjobcard.length >0">
                <label> <b>Job Cards</b></label>
                <table class="small_view" style="border: 1px solid #eee">
                    <thead>
                        <tr>
                            <th>JC Number</th>
                            <th>Status</th>
                            <th>Vehicle Number</th>
                            <th>Vehicle Family</th>
                            <th>Vehicle Model</th>
                            <th>Service Advisor</th>
                            <th>INV No</th>
                            <th>INV Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let jc of custjobcard">
                            <td>
                                <b>{{ jc.job_no }}</b>
                            </td>
                            <td>{{ jc.job_status }}</td>
                            <td>{{ jc.car_reg_no }}</td>
                            <td>{{ jc.brand_code }},{{ jc.family_name }}</td>
                            <td>{{ jc.model_name }},{{ jc.model_year }}</td>
                            <td>{{ jc.user_name }}</td>
                            <td>{{ jc.invoice_no }}</td>
                            <td>{{jc.invoice_date }}</td>
                        </tr>
                    </tbody>
                </table>
            </div> -->
            <hr class="my-2 dark:border-[#191e3a]" style="border: 1px solid #eee" *ngIf="customerdata.length !='0'" />
            <div class="table-responsive" *ngIf="custleads.length > 0">
                <label> <b>Leads</b></label>
                <table class="small_view" style="border: 1px solid #eee">
                    <thead>
                        <tr>
                            <th>Created</th>
                            <th>Lead Code</th>
                            <th>Status</th>
                            <th>Source</th>
                            <th>Note</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let ld of custleads">
                            <td>{{ ld.created }}</td>
                            <td>
                                <span class="badge badge-outline-primary">{{ ld.lead_code }}</span>
                            </td>
                            <td>{{ ld.ld_sts }}</td>
                            <td>{{ld.ld_src }}</td>
                            <td>{{ld.lead_note}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <hr class="my-2 dark:border-[#191e3a]" style="border: 1px solid #eee" *ngIf="custleads.length > 0" />
            <div class="table-responsive">
                <label> <b>Recent Call Logs</b></label>
                <table class="small_view" style="border: 1px solid #eee">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Staff</th>
                            <th>Purpose</th>
                            <th>Reason</th>
                        </tr>
                    </thead>
                    <tbody>
                        <ng-container *ngIf="log.length!=0">
                            <tr [ngSwitch]="lg.calltype" *ngFor="let lg of log">
                                <td>{{ lg.datetime }}</td>
                                <td
                                    [ngClass]="{'text-success': lg.calltype === 'Inbound', 'text-warning': lg.calltype === 'Outbound'}">
                                    {{ lg.calltype }}</td>
                                <td
                                    [ngClass]="{'text-danger': lg.disposition === 'NO ANSWER', 'text-primary': lg.disposition !== 'NO ANSWER'}">
                                    {{ lg.disposition }}
                                </td>
                                <td>{{ lg.calltype === 'Inbound' ? lg.dst : lg.src }}</td>
                                <td
                                    [ngClass]="{'text-danger': lg.purpose === 'fail', 'text-primary': lg.purpose !== 'fail'}">
                                    {{ lg.purpose === 'fail' ? 'Not Found' : lg.purpose }}
                                </td>
                                <td
                                    [ngClass]="{'text-danger': lg.leadlog === 'fail', 'text-primary': lg.leadlog !== 'fail'}">
                                    {{ lg.leadlog === 'fail' ? 'Not Found' : lg.leadlog }}
                                </td>
                            </tr>
                        </ng-container>
                        <ng-container *ngIf="log.length == 0">
                            <tr>
                                <td style="text-align: center;" colspan="6"><span><b>No Recent Call Logs</b></span></td>
                            </tr>
                        </ng-container>
                    </tbody>
                </table>
            </div>
        </div>
    </ng-template>
    <ng-template #modalFooter>
        <button type="button" (click)="custDetailModalClose()" class="btn btn-outline-danger">DISMISS</button>
    </ng-template>
</modal>