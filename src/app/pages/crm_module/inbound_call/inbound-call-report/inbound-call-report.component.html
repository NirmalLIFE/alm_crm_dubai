<ol class="flex font-semibold text-primary dark:text-white-dark">
    <li class="bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]">
        <a routerLink="/dashboard"
            class="relative flex h-full items-center p-1.5 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-3 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-3 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">Home</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180">
            MIS</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center p-1.5 px-3 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-6 ltr:before:-right-[15px] rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">
            Inbound Call Reports</a>
    </li>
</ol>
<div class="mb-5">
    <div
        class="mt-3 mb-5 grid grid-cols-4 gap-2 rtl:space-x-reverse sm:flex sm:flex-wrap sm:justify-center sm:space-x-3">
        <a href="javascript:;"
            class="flex flex-col items-center justify-center rounded-lg bg-[#f1f2f3] p-7 py-3 !outline-none transition duration-300  dark:bg-[#191e3a] custom-tab"
            [ngClass]="{ '!bg-gradient-to-r from-[#009ffd] to-[#2a2a72] text-white': tab17.toLowerCase() === 'home' }"
            (click)="tab17 = 'home'">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                class="mb-1 h-5 w-5">
                <path
                    d="M16.1007 13.359L16.5562 12.9062C17.1858 12.2801 18.1672 12.1515 18.9728 12.5894L20.8833 13.628C22.1102 14.2949 22.3806 15.9295 21.4217 16.883L20.0011 18.2954C19.6399 18.6546 19.1917 18.9171 18.6763 18.9651M4.00289 5.74561C3.96765 5.12559 4.25823 4.56668 4.69185 4.13552L6.26145 2.57483C7.13596 1.70529 8.61028 1.83992 9.37326 2.85908L10.6342 4.54348C11.2507 5.36691 11.1841 6.49484 10.4775 7.19738L10.1907 7.48257"
                    stroke="currentColor" stroke-width="1.5"></path>
                <path opacity="0.5"
                    d="M18.6763 18.9651C17.0469 19.117 13.0622 18.9492 8.8154 14.7266C4.81076 10.7447 4.09308 7.33182 4.00293 5.74561"
                    stroke="currentColor" stroke-width="1.5"></path>
                <path opacity="0.5"
                    d="M16.1007 13.3589C16.1007 13.3589 15.0181 14.4353 12.0631 11.4971C9.10807 8.55886 10.1907 7.48242 10.1907 7.48242"
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
            </svg>
            Unique Inbound Call
        </a>

        <a href="javascript:;"
            class="flex flex-col items-center justify-center rounded-lg bg-[#f1f2f3] p-7 py-3 !outline-none transition duration-300 dark:bg-[#191e3a] custom-tab"
            [ngClass]="{ '!bg-gradient-to-r from-[#009ffd] to-[#2a2a72] text-white': tab17.toLowerCase() === 'profile' }"
            (click)="tab17 = 'profile'">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                class="mb-1 h-5 w-5">
                <path
                    d="M16.1007 13.359L16.5562 12.9062C17.1858 12.2801 18.1672 12.1515 18.9728 12.5894L20.8833 13.628C22.1102 14.2949 22.3806 15.9295 21.4217 16.883L20.0011 18.2954C19.6399 18.6546 19.1917 18.9171 18.6763 18.9651M4.00289 5.74561C3.96765 5.12559 4.25823 4.56668 4.69185 4.13552L6.26145 2.57483C7.13596 1.70529 8.61028 1.83992 9.37326 2.85908L10.6342 4.54348C11.2507 5.36691 11.1841 6.49484 10.4775 7.19738L10.1907 7.48257"
                    stroke="currentColor" stroke-width="1.5"></path>
                <path opacity="0.5"
                    d="M18.6763 18.9651C17.0469 19.117 13.0622 18.9492 8.8154 14.7266C4.81076 10.7447 4.09308 7.33182 4.00293 5.74561"
                    stroke="currentColor" stroke-width="1.5"></path>
                <path opacity="0.5"
                    d="M16.1007 13.3589C16.1007 13.3589 15.0181 14.4353 12.0631 11.4971C9.10807 8.55886 10.1907 7.48242 10.1907 7.48242"
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
            </svg>
            Inbound Call Report
        </a>

        <a href="javascript:;"
            class="flex flex-col items-center justify-center rounded-lg bg-[#f1f2f3] p-7 py-3 !outline-none transition duration-300 dark:bg-[#191e3a] custom-tab "
            [ngClass]="{
                'bg-gradient-to-r from-[#009ffd] to-[#2a2a72] text-white': tab17.toLowerCase() === 'contact',
                'hover:bg-gradient-to-r hover:from-[#009ffd] hover:to-[#2a2a72] hover:text-white hover:shadow-[0_5px_15px_0_rgba(0,0,0,0.30)]': tab17.toLowerCase() === 'contact'
            }" (click)="tab17 = 'contact'">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                class="mb-1 h-5 w-5">
                <path
                    d="M16.1007 13.359L16.5562 12.9062C17.1858 12.2801 18.1672 12.1515 18.9728 12.5894L20.8833 13.628C22.1102 14.2949 22.3806 15.9295 21.4217 16.883L20.0011 18.2954C19.6399 18.6546 19.1917 18.9171 18.6763 18.9651M4.00289 5.74561C3.96765 5.12559 4.25823 4.56668 4.69185 4.13552L6.26145 2.57483C7.13596 1.70529 8.61028 1.83992 9.37326 2.85908L10.6342 4.54348C11.2507 5.36691 11.1841 6.49484 10.4775 7.19738L10.1907 7.48257"
                    stroke="currentColor" stroke-width="1.5"></path>
                <path opacity="0.5"
                    d="M18.6763 18.9651C17.0469 19.117 13.0622 18.9492 8.8154 14.7266C4.81076 10.7447 4.09308 7.33182 4.00293 5.74561"
                    stroke="currentColor" stroke-width="1.5"></path>
                <path opacity="0.5"
                    d="M16.1007 13.3589C16.1007 13.3589 15.0181 14.4353 12.0631 11.4971C9.10807 8.55886 10.1907 7.48242 10.1907 7.48242"
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
            </svg>
            Inbound Call Analysis
        </a>
    </div>
    <div class="flex-1 text-sm">
        <div *ngIf="tab17.toLowerCase() === 'home'">
            <div *ngIf="load_flag" style="text-align: center">
                <span
                    class="m-auto mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"></span>
            </div>
            <div *ngIf="!load_flag">
                <div class="mb-5 grid flex-1 grid-cols-2 gap-2 lg:grid-cols-3 xl:grid-cols-4">
                    <div>
                        <label for="name" class="small_label_text m-0 dark:text-white-dark">Start Date</label>
                        <input type="date" [(ngModel)]="start_date" class="form-input" ngxTippy="Start Date"
                            placeholder="Start Date From" />
                    </div>
                    <div>
                        <label for="name" class="small_label_text m-0 dark:text-white-dark">End Date</label>
                        <input type="date" [(ngModel)]="end_date" class="form-input" ngxTippy="End Date"
                            placeholder="End Date From" />
                    </div>
                    <div>
                        <label for="name" class="small_label_text m-0 dark:text-white-dark"
                            style="color: white;">.</label>
                        <button type="button" (click)="getinboundcalls()"
                            class="btn btn-outline-primary">SEARCH</button>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-4 md:grid-cols-4 md:items-center lg:grid-cols-4 mb-5">
                    <div class="grid grid-cols-2 col-span-2 gap-3 mb-5">
                        <div class="panel flex" (click)="openUniqueCallDetailModal('uniqueCalls')" style="background: linear-gradient(to right,#4bb6e3, #2E86AB); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Total Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{arr_sample_unique.length}}</div>
                        </div>
                        <div class="panel flex" (click)="openUniqueCallDetailModal('uniqueMarkCalls')" style="background: linear-gradient(to right, #28714e, #56c48f); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Marketing Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{uniqueMarkCalls.length}}</div>
                        </div>
                        <div class="panel flex" (click)="openUniqueCallDetailModal('uniqueNonMarkCalls')" style="background: linear-gradient(to right, #375b62, #5ca4b3); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Non Marketing Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{uniqueNonMarkCalls.length}}</div>
                        </div>
                        <div class="panel flex" (click)="openUniqueCallDetailModal('uniqueNewCalls')" style="background: linear-gradient(to right,#317edd, #32507b); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">New Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{uniqueNewCallsCount.length}}</div>
                        </div>
                        <div class="panel flex" (click)="openUniqueCallDetailModal('uniqueMissCalls')" style="background: linear-gradient(to right,  #922628, #e70004); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Missed Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{uniqueMissCalls.length}}</div>
                        </div>
                    </div>
                    <div class="col-span-2" *ngIf="call_graph_flag">
                        <div class="ng-tns-c35-16 mb-5 flex items-start justify-between" style="place-content: center;">
                            <h5 class="ng-tns-c35-16 text-lg font-semibold dark:text-white-light">Call Analysis</h5>
                        </div>
                        <apx-chart [series]="chartOptions.series" [chart]="chartOptions.chart"
                            [dataLabels]="chartOptions.dataLabels" [plotOptions]="chartOptions.plotOptions"
                            [yaxis]="chartOptions.yaxis" [xaxis]="chartOptions.xaxis" [legend]="chartOptions.legend"
                            [colors]="chartOptions.colors" [grid]="chartOptions.grid">
                        </apx-chart>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-4 md:grid-cols-4 md:items-center lg:grid-cols-4 mb-5" *ngIf="custconvertedcall.length>0 || uniqueactivecustomer.length>0">
                    <div class="col-span-2" *ngIf="custconvertedcall.length>0">
                        <div class="ng-tns-c35-16 mb-5 flex items-start justify-between" style="place-content: center;">
                            <h5 class="ng-tns-c35-16 text-lg font-semibold dark:text-white-light">Customer Analysis</h5>
                        </div>
                        <apx-chart [series]="pieChart.series" [chart]="pieChart.chart" [labels]="pieChart.labels"
                            [colors]="pieChart.colors" [responsive]="pieChart.responsive" [stroke]="pieChart.stroke"
                            [legend]="pieChart.legend" class="rounded-lg bg-white dark:bg-black"></apx-chart>
                    </div>
                    <div class="grid grid-cols-2 col-span-2 gap-3 mb-5">
                        <div class="panel flex" (click)="openUniqueCallDetailModal('custconvertedcall')" style="background: linear-gradient(to right,  #58ac1e, #75be71); cursor: pointer; color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Converted Customers</div>
                            <div class="mt-3 text-3xl font-bold">{{custconvertedcall.length}}</div>
                        </div>
                        <div class="panel flex"  (click)="openUniqueCallDetailModal('uniquemarkconvertcust')" style="background: linear-gradient(to right, #4DA167, #87BBA2); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Marketing Converted</div>
                            <div class="mt-3 text-3xl font-bold">{{uniquemarkconvertcust.length}}</div>
                        </div>
                        <div class="panel flex" (click)="openUniqueCallDetailModal('uniquenonmarkconvertcust')" style="background: linear-gradient(to right, #609c7c, #5ea2af); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Non Marketing Converted</div>
                            <div class="mt-3 text-3xl font-bold">{{uniquenonmarkconvertcust.length}}</div>
                        </div>
                        <div class="panel flex"  (click)="openUniqueCallDetailModal('uniqueactivecustomer')" style="background: linear-gradient(to right, #ac7fcb,#593959); cursor: pointer;color: white;
                            font-size: smaller;">
                            <div class="text-md font-semibold">Active Jobcards</div>
                            <div class="mt-3 text-3xl font-bold">{{uniqueactivecustomer.length}}</div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
        <div *ngIf="tab17.toLowerCase() === 'profile'">
            <!-- <div class="mb-6 grid grid-cols-1 gap-6 text-white sm:grid-cols-2 xl:grid-cols-4">
                <form [formGroup]="form3">
                    <ng2-flatpickr [config]="rangeCalendar" [(ngModel)]="daterange" formControlName="date3"
                        (change)="getingoundcalls()" ngxTippy="Select Date" placeholder="Select Date Range"
                        addClass="form-input"></ng2-flatpickr>
                </form>
            </div> -->
            <div *ngIf="load_flag" style="text-align: center">
                <span
                    class="m-auto mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"></span>
            </div>
            <div *ngIf="!load_flag">
                <div class="pt-5">
                    <div class="mb-5 grid flex-1 grid-cols-2 gap-2 lg:grid-cols-3 xl:grid-cols-4">
                        <!-- <div>
                            <ng2-flatpickr [config]="rangeCalendar" [(ngModel)]="daterange"
                                ngxTippy="Select Date Range" placeholder="Select Date Range"
                                addClass="form-input"></ng2-flatpickr>
                        </div> -->
                        <div>
                            <label for="name" class="small_label_text m-0 dark:text-white-dark">Start Date</label>
                            <input type="date" [(ngModel)]="start_date" class="form-input" ngxTippy="Start Date"
                                placeholder="Start Date From" />
                        </div>
                        <div>
                            <label for="name" class="small_label_text m-0 dark:text-white-dark">End Date</label>
                            <input type="date" [(ngModel)]="end_date" class="form-input" ngxTippy="End Date"
                                placeholder="End Date From" />
                        </div>
                        <div>
                            <label for="name" class="small_label_text m-0 dark:text-white-dark"
                                style="color: white;">.</label>
                            <button type="button" (click)="getinboundcalls()"
                                class="btn btn-outline-primary">SEARCH</button>
                        </div>
                    </div>
                    <div class="mb-5 grid flex-1 grid-cols-2 gap-2 lg:grid-cols-3 xl:grid-cols-4">
                        <div>
                            <label for="name" class="small_label_text m-0 dark:text-white-dark">Department</label>
                            <ng-select [searchable]="true" [clearable]="false" class="custom-multiselect"
                                [(ngModel)]="filterParams.department_param" (change)="CallFilter()">
                                <ng-option value="0">All </ng-option>
                                <ng-option value="1">Marketing Calls</ng-option>
                                <ng-option value="2">Non Marketing Calls </ng-option>
                            </ng-select>
                        </div>
                        <div>
                            <label for="name" class="small_label_text m-0 dark:text-white-dark">Customer Type</label>
                            <ng-select [searchable]="true" [clearable]="false" class="custom-multiselect"
                                [(ngModel)]="filterParams.customerType" (change)="CallFilter()">
                                <ng-option value="ALL">All</ng-option>
                                <ng-option value="M">Maraghi</ng-option>
                                <ng-option value="C">CRM </ng-option>
                            </ng-select>
                        </div>
                        <div>
                            <label for="name" class="small_label_text m-0 dark:text-white-dark">User Name</label>
                            <ng-select [searchable]="true" [clearable]="false" class="custom-multiselect"
                                [(ngModel)]="filterParams.username" (change)="CallFilter()">
                                <ng-option value="ALL">All</ng-option>
                                <ng-option *ngFor="let user of userlist" value="{{user.ext_number}}">{{
                                    user.us_firstname }}
                                    <br />
                                    ({{ user.ext_number }})</ng-option>
                            </ng-select>
                        </div>
                        <div>
                            <label for="name" class="small_label_text m-0 dark:text-white-dark">Purpose</label>
                            <ng-select [searchable]="true" [clearable]="false" class="custom-multiselect"
                                [(ngModel)]="filterParams.call_purpose" (change)="CallFilter()">
                                <ng-option value="ALL">ALL</ng-option>
                                <ng-option *ngFor="let option of purposeList" value="{{ option.call_purpose}}">{{
                                    option.call_purpose }}</ng-option>
                            </ng-select>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 gap-4 md:grid-cols-4 md:items-center lg:grid-cols-6 mb-5">
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #258EA6, #258EA6); cursor: pointer"
                            (click)="cardfilter('totalcall')">
                            <div class="text-md font-semibold">Total Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{ totalincall }}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #549F93, #549F93); cursor: pointer"
                            (click)="cardfilter('newcust')">
                            <div class="text-md font-semibold">Total Customers</div>
                            <div class="mt-3 text-3xl font-bold">{{ newcustcount }}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #9FAF90, #9FAF90); cursor: pointer"
                            (click)="cardfilter('newcall')">
                            <div class="text-md font-semibold">New Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{ newcus }}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #E2B1B1, #E2B1B1); cursor: pointer"
                            (click)="cardfilter('existcall')">
                            <div class="text-md font-semibold">Total Existing Customers</div>
                            <div class="mt-3 text-3xl font-bold">{{exscus}}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #748CAB, #748CAB); cursor: pointer"
                            (click)="cardfilter('activecall')">
                            <div class="text-md font-semibold">Active Customers</div>
                            <div class="mt-3 text-3xl font-bold">{{activejobcards}}</div>
                        </div>
                        <div class="panel bg-gradient-to-r from-gray-500 to-gray-400 flex" style="cursor: pointer"
                            (click)="cardfilter('custconvertedcall')">
                            <div class="text-md font-semibold">Converted Customer</div>
                            <div class="mt-3 text-3xl font-bold">{{totalconvertedcust}}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #00bf8f, #001510bf);cursor: pointer;"
                            (click)="cardfilter('markcall')">
                            <div class="text-md font-semibold">Marketing Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{totalmarkcount}}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #76949F, #76949F); cursor: pointer"
                            (click)="cardfilter('nonmarkcall')">
                            <div class="text-md font-semibold">Non Marketing Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{totalnonmarkcount}}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #5E6973, #5E6973); cursor: pointer"
                            (click)="cardfilter('appointcall')">
                            <div class="text-md font-semibold">Total Appointments</div>
                            <div class="mt-3 text-3xl font-bold">{{totalapcount}}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #8AA29E, #8AA29E); cursor: pointer"
                            (click)="cardfilter('misscalls')">
                            <div class="text-md font-semibold">Total Missed Calls</div>
                            <div class="mt-3 text-3xl font-bold">{{totalmiscount}}</div>
                        </div>
                        <div class="panel flex"
                            style="background: linear-gradient(to right, #DB5461, #DB5461); cursor: pointer"
                            (click)="cardfilter('nopurpose')">
                            <div class="text-md font-semibold">Purpose Missing</div>
                            <div class="mt-3 text-3xl font-bold">{{c_nopurpose}}</div>
                        </div>
                    </div>
                    <div class="mb-5 flex flex-col gap-5 md:flex-row md:items-center">
                        <label class="inline-flex">
                            <input type="checkbox" class="form-checkbox outline-primary" [(ngModel)]="isChecked"
                                (change)="checkValue(isChecked ? true : false)" />
                            <span>Include Common Numbers</span>
                        </label>
                    </div>
                </div>
                <div class="panel mt-5 pb-0">
                    <div class="mb-5 flex flex-col gap-5 md:flex-row md:items-center">
                        <!-- <input [(ngModel)]="selectedDate" type="date" class="form-input" ngxTippy="Invoice Date From"
                                placeholder="Invoice Date From" (change)="getStaffCallLog()" style="width: 25%" /> -->
                        <!-- <form [formGroup]="form3">
                            <ng2-flatpickr [config]="rangeCalendar" [(ngModel)]="daterange" formControlName="date3"
                                (change)="selecteddate()" ngxTippy="Select Date" placeholder="Select Date Range"
                                addClass="form-input"></ng2-flatpickr>
                        </form> -->
                        <div class="flex items-center gap-5 ltr:ml-auto rtl:mr-auto">
                            <div hlMenu class="dropdown">
                                <button hlMenuButton type="button"
                                    class="flex items-center rounded-md border border-[#e0e6ed] px-4 py-2 text-sm font-semibold dark:border-[#253b5c] dark:bg-[#1b2e4b] dark:text-white-dark">
                                    <span class="ltr:mr-1 rtl:ml-1">Columns</span>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg" class="h-5 w-5">
                                        <path d="M19 9L12 15L5 9" stroke="currentColor" stroke-width="1.5"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </button>
                                <ul *hlMenuItems @toggleAnimation class="w-max ltr:left-0 rtl:right-0"
                                    style="z-index: 100">
                                    <ng-container *ngFor="let col of cols; index as i">
                                        <li>
                                            <div class="flex items-center px-4 py-1">
                                                <label [for]="'chk-' + i" class="mb-0 cursor-pointer">
                                                    <input type="checkbox" [id]="'chk-' + i" class="form-checkbox"
                                                        [(ngModel)]="!col.hide" (change)="updateColumn(col)" />
                                                    <span class="ltr:ml-2 rtl:mr-2">{{ col.title }}</span>
                                                </label>
                                            </div>
                                        </li>
                                    </ng-container>
                                </ul>
                            </div>
                            <input [(ngModel)]="search" type="text" class="form-input w-auto" placeholder="Search..." />
                        </div>
                    </div>
                    <div class="datatable">
                        <ng-datatable [rows]="arr_sample" [columns]="cols" [search]="search" [sortable]="true"
                            [columnFilter]="false" skin="whitespace-nowrap table-hover bh-table-compact"
                            firstArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                            lastArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg> '
                            previousArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                            nextArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'>
                            <!-- <ng-template slot="action" let-value="data">
                                    <button type="button" ngxTippy="Update Call Details" (click)="updateCallDetails(value)"
                                        class="btn btn-primary btn-sm h-6 w-6 rounded-full p-0"
                                        *ngIf="value.pupose_id == '0'">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                            fill="none">
                                            <path
                                                d="M18.18 8.03933L18.6435 7.57589C19.4113 6.80804 20.6563 6.80804 21.4241 7.57589C22.192 8.34374 22.192 9.58868 21.4241 10.3565L20.9607 10.82M18.18 8.03933C18.18 8.03933 18.238 9.02414 19.1069 9.89309C19.9759 10.762 20.9607 10.82 20.9607 10.82M18.18 8.03933L13.9194 12.2999C13.6308 12.5885 13.4865 12.7328 13.3624 12.8919C13.2161 13.0796 13.0906 13.2827 12.9882 13.4975C12.9014 13.6797 12.8368 13.8732 12.7078 14.2604L12.2946 15.5L12.1609 15.901M20.9607 10.82L16.7001 15.0806C16.4115 15.3692 16.2672 15.5135 16.1081 15.6376C15.9204 15.7839 15.7173 15.9094 15.5025 16.0118C15.3203 16.0986 15.1268 16.1632 14.7396 16.2922L13.5 16.7054L13.099 16.8391M13.099 16.8391L12.6979 16.9728C12.5074 17.0363 12.2973 16.9867 12.1553 16.8447C12.0133 16.7027 11.9637 16.4926 12.0272 16.3021L12.1609 15.901M13.099 16.8391L12.1609 15.901"
                                                stroke="#fff" stroke-width="1.5" />
                                            <path d="M8 13H10.5" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                                            <path d="M8 9H14.5" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                                            <path d="M8 17H9.5" stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                                            <path
                                                d="M19.8284 3.17157C18.6569 2 16.7712 2 13 2H11C7.22876 2 5.34315 2 4.17157 3.17157C3 4.34315 3 6.22876 3 10V14C3 17.7712 3 19.6569 4.17157 20.8284C5.34315 22 7.22876 22 11 22H13C16.7712 22 18.6569 22 19.8284 20.8284C20.7715 19.8853 20.9554 18.4796 20.9913 16"
                                                stroke="#fff" stroke-width="1.5" stroke-linecap="round" />
                                        </svg>
                                    </button>
                                </ng-template> -->
                            <ng-template slot="call_time" let-value="data">
                                <span>{{ value.call_time }}</span>
                            </ng-template>
                            <ng-template slot="customer" let-value="data">
                                <span *ngIf="value.customer!='new' && value.customer!='EXISTS'"
                                    style="text-transform: capitalize;cursor: pointer;" class="text-success"
                                    (click)="opencustDetailModal(value.call_from)">
                                    {{ value.customer }}</span>
                                <span *ngIf="value.customer=='new' || value.customer =='EXISTS'"
                                    style="text-transform: capitalize" class="text-success">
                                    {{ value.customer }}</span>
                            </ng-template>
                            <ng-template slot="convert" let-value="data">
                                <span *ngIf="value.convert == 'true' && value.jc_status == 'active'">Active</span>
                                <span *ngIf="value.convert == 'true' && value.jc_status != 'active'">Converted</span>
                                <span *ngIf="value.convert == 'fail' && value.jc_status == 'active'">Active</span>
                                <span *ngIf="value.convert == 'fail' && value.jc_status != 'active'">Not</span>
                            </ng-template>
                            <ng-template slot="lead" let-value="data">
                                <span *ngIf="value.lead != 'fail'">
                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                        (click)="openLeadDetailModal(value.lead_id)">
                                        {{ value.lead }}
                                    </button>
                                </span>
                                <span *ngIf="value.lead == 'fail'">NIL</span>
                            </ng-template>
                            <ng-template slot="call_from" let-value="data">
                                <button type="button" class="btn btn-outline-secondary btn-sm"
                                    (click)="openCallLogs(value.call_from)" ngxTippy="{{ value.call_from }}"
                                    [tippyProps]="{ theme: 'info' }">
                                    ****{{ value.call_from | slice : -6 }}
                                </button>
                            </ng-template>
                            <ng-template slot="call_details" let-value="data">
                                <div style="border: 1px solid #00000085; border-radius: 15px; margin-top: 4px; text-align: center"
                                    *ngFor="let rowc of value.call_list; let i = index">
                                    <span style="display: inline-flex">
                                        <p style="margin: 4px; font-size: 12px">{{ rowc.datetime }} -</p>
                                        <p style="margin: 4px; font-size: 14px">
                                            <b>{{ rowc.dst }}</b>
                                        </p>
                                    </span><br />
                                    <span style="display: inline-flex">
                                        <p *ngIf="rowc.disposition == 'NO ANSWER'"
                                            style="margin-bottom: 0; font-size: 12px; font-weight: 700; color: red">
                                            {{ rowc.disposition }}
                                        </p>
                                        <p *ngIf="rowc.disposition != 'NO ANSWER'"
                                            style="margin-bottom: 0; font-size: 12px; font-weight: 700">{{
                                            rowc.disposition }}</p>
                                    </span>
                                    <br />
                                    <span *ngIf="rowc.purpose != 'fail'" style="font-size: 12px">
                                        <b> ({{ rowc.purpose }})</b>
                                    </span>
                                    <span *ngIf="rowc.purpose == 'fail' &&rowc.disposition == 'ANSWERED'"
                                        style="margin-bottom: 0; font-size: 12px; color: red">
                                        (Purpose NIL)
                                    </span>
                                    <br />
                                    <span *ngIf="rowc.leadlog == 'fail' && rowc.disposition == 'ANSWERED'"
                                        style="font-size: 12px; color: red">
                                        NIL
                                    </span>
                                    <span *ngIf="rowc.leadlog != 'fail'" style="font-size: 12px">
                                        {{ rowc.leadlog }}
                                    </span>
                                </div>
                                <div style="border: 1px solid #00000085; border-radius: 15px; margin-top: 4px; text-align: center"
                                    *ngIf="value.outboundcalldata && value.outboundcalldata.length > 0">
                                    <span style="display: inline-flex">
                                        <b>{{value.outboundcalldata[value.outboundcalldata.length - 1].username}}</b>
                                    </span>
                                    <br />
                                    <span style="display: inline-flex">
                                        <p style="margin: 4px; font-size: 12px">
                                            {{ value.outboundcalldata[value.outboundcalldata.length - 1].datetime }} -
                                        </p>
                                        <p style="margin: 4px; font-size: 14px">
                                            <b>{{ value.outboundcalldata[value.outboundcalldata.length - 1].dst }}</b>
                                        </p>
                                    </span><br />
                                    <span style="display: inline-flex">
                                        <p *ngIf="value.outboundcalldata[value.outboundcalldata.length - 1].disposition == 'NO ANSWER'"
                                            style="margin-bottom: 0; font-size: 12px; font-weight: 700; color: red">
                                            {{ value.outboundcalldata[value.outboundcalldata.length - 1].disposition }}
                                        </p>
                                        <p *ngIf="value.outboundcalldata[value.outboundcalldata.length - 1].disposition != 'NO ANSWER'"
                                            style="margin-bottom: 0; font-size: 12px; font-weight: 700">
                                            {{value.outboundcalldata[value.outboundcalldata.length - 1].disposition }}
                                        </p>
                                    </span>
                                    <br />
                                    <span
                                        *ngIf="value.outboundcalldata[ value.outboundcalldata.length - 1].purpose != 'fail'"
                                        style="font-size: 12px">
                                        <b> ({{ value.outboundcalldata[value.outboundcalldata.length - 1].purpose
                                            }})</b>
                                    </span>
                                    <span
                                        *ngIf="value.outboundcalldata[value.outboundcalldata.length - 1].purpose == 'fail' &&
                                        value.outboundcalldata[value.outboundcalldata.length - 1].disposition == 'ANSWERED'"
                                        style="margin-bottom: 0; font-size: 12px; color: red">
                                        (Purpose NIL)
                                    </span>
                                    <br />
                                    <span
                                        *ngIf="value.outboundcalldata[value.outboundcalldata.length - 1].leadlog == 'fail' && 
                                        value.outboundcalldata[value.outboundcalldata.length - 1].disposition == 'ANSWERED'"
                                        style="font-size: 12px; color: red">
                                        NIL
                                    </span>
                                    <span
                                        *ngIf="value.outboundcalldata[value.outboundcalldata.length - 1].leadlog != 'fail'"
                                        style="font-size: 12px">
                                        {{ value.outboundcalldata[value.outboundcalldata.length - 1].leadlog }}
                                    </span>
                                </div>
                            </ng-template>
                        </ng-datatable>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div *ngIf="tab17.toLowerCase() === 'contact'">
    <app-inbound-call-analysis></app-inbound-call-analysis>
</div>
<modal #calllogmodal class="modal-top animate animate-slide-in-down extra-large-modal call-view"
    [closeOnOutsideClick]="false" style="max-width: 90vw;">
    <ng-template #modalHeader>
        <div style=" align-items: center; display: flex; ">
            Recent Call Logs
        </div>
    </ng-template>
    <ng-template #modalBody>
        <app-call-log-detail [calllogphn]="calllogphn"></app-call-log-detail>
    </ng-template>
    <ng-template #modalFooter>
        <button type="button" (click)="callhistoryModal()" class="btn btn-outline-danger">DISMISS</button>
    </ng-template>
</modal>
<modal #leadDetailModal class="modal-top animate animate-slide-in-down extra-large-modal call-view"
    [closeOnOutsideClick]="false" style="max-width: 90vw;">
    <ng-template #modalHeader>
        <div style=" align-items: center; display: flex; ">
            Lead Details
        </div>
    </ng-template>
    <ng-template #modalBody>
        <app-lead-detail-screen [leadDetail]="leadDetail"></app-lead-detail-screen>
    </ng-template>
    <ng-template #modalFooter>
        <button type="button" (click)="LeadDetailModalClose()" class="btn btn-outline-danger">DISMISS</button>
    </ng-template>
</modal>
<modal #custDetailModal class="modal-top animate animate-slide-in-down extra-large-modal call-view"
    [closeOnOutsideClick]="false" style="max-width: 90vw;">
    <ng-template #modalHeader>
        <div style=" align-items: center; display: flex; ">
            Customer Details
        </div>
    </ng-template>
    <ng-template #modalBody>
        <div class="table-responsive" *ngIf="customerdata != null">
            <table class="small_view" style="border: 1px solid #eee">
                <thead>
                    <tr>
                        <th style="width: 20%">Name</th>
                        <th style="width: 12%">Location</th>
                        <th>Latest Job-card</th>
                        <th style="width: 15%" class="text-center">Latest SA</th>
                        <th class="text-center">Last Invoiced</th>
                        <th style="width: 20%" class="text-center">Vehicles</th>
                        <th class="text-right">Total Job-cards</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <b>{{ customerdata.customer_name }}</b>
                        </td>
                        <td>{{ customerdata.city }}</td>
                        <td>
                            <span class="badge badge-outline-primary" *ngIf="custjobcard.length >0">{{
                                custjobcard[0].job_no }}</span>
                        </td>
                        <td>
                            <b *ngIf="custjobcard.length >0">{{ custjobcard[0].user_name }}</b>
                        </td>
                        <td *ngIf="custjobcard.length >0">{{ custjobcard[0].invoice_date }}</td>
                        <td>
                            <span *ngFor="let veh of custvehicle">{{ veh.reg_no }}, </span>
                        </td>
                        <td class="text-right">{{ custjobcard.length }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <hr class="my-2 dark:border-[#191e3a]" style="border: 1px solid #eee" />
        <div class="table-responsive" *ngIf="custjobcard.length >0">
            <label> <b>Job Cards</b></label>
            <table class="small_view" style="border: 1px solid #eee">
                <thead>
                    <tr>
                        <th>JC Number</th>
                        <th>Status</th>
                        <th>Vehicle Number</th>
                        <th>Vehicle Family</th>
                        <th>Vehicle Model</th>
                        <th>Service Advisor</th>
                        <th>INV No</th>
                        <th>INV Date</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let jc of custjobcard">
                        <td>
                            <b>{{ jc.job_no }}</b>
                        </td>
                        <td>{{ jc.job_status }}</td>
                        <td>{{ jc.car_reg_no }}</td>
                        <td>{{ jc.brand_code }},{{ jc.family_name }}</td>
                        <td>{{ jc.model_name }},{{ jc.model_year }}</td>
                        <td>{{ jc.user_name }}</td>
                        <td>{{ jc.invoice_no }}</td>
                        <td>{{jc.invoice_date }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <hr class="my-2 dark:border-[#191e3a]" style="border: 1px solid #eee" />
        <div class="table-responsive" *ngIf="custleads.length > 0">
            <label> <b>Leads</b></label>
            <table class="small_view" style="border: 1px solid #eee">
                <thead>
                    <tr>
                        <th>Created</th>
                        <th>Lead Code</th>
                        <th>Status</th>
                        <th>Source</th>
                        <th>Note</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let ld of custleads">
                        <td>{{ ld.created }}</td>
                        <td>
                            <span class="badge badge-outline-primary">{{ ld.lead_code }}</span>
                        </td>
                        <td>{{ ld.ld_sts }}</td>
                        <td>{{ld.ld_src }}</td>
                        <td>{{ld.lead_note}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </ng-template>
    <ng-template #modalFooter>
        <button type="button" (click)="custDetailModalClose()" class="btn btn-outline-danger">DISMISS</button>
    </ng-template>
</modal>
<modal #uniqueCallDetailModal class="modal-top animate animate-slide-in-down extra-large-modal call-view"
    [closeOnOutsideClick]="false" style="max-width: 90vw;">
    <ng-template #modalHeader>
        <div style=" align-items: center; display: flex; ">
            CUSTOMER INFO
        </div>
    </ng-template>
    <ng-template #modalBody>
        <div class="mb-5 flex flex-col gap-5 md:flex-row md:items-center">
            <div class="flex items-center gap-5 ltr:ml-auto rtl:mr-auto">
                <input [(ngModel)]="search" type="text" class="form-input w-auto" placeholder="Search..." />
            </div>
        </div>
        <div class="datatable">
            <ng-datatable [rows]="unique_arr" [columns]="cols_2" [search]="search" [sortable]="true"
                [columnFilter]="false" skin="whitespace-nowrap table-hover bh-table-compact"
                firstArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                lastArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg> '
                previousArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'
                nextArrow='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>'>
                <ng-template slot="customer" let-value="data">
                    <span *ngIf="value.customer!='new' && value.customer!='EXISTS'"
                        style="text-transform: capitalize;cursor: pointer;" class="text-success">
                        {{ value.customer }}</span>
                    <span *ngIf="value.customer=='new' || value.customer =='EXISTS'" style="text-transform: capitalize"
                        class="text-success">
                        {{ value.customer }}</span>
                </ng-template>
                <ng-template slot="call_from" let-value="data">
                    <button type="button" class="btn btn-outline-secondary btn-sm" ngxTippy="{{ value.call_from }}"
                        [tippyProps]="{ theme: 'info' }">
                        ****{{ value.call_from | slice : -6 }}
                    </button>
                </ng-template>
            </ng-datatable>
        </div>
    </ng-template>
    <ng-template #modalFooter>
        <button type="button" (click)="uniqueCallDetailModalClose()" class="btn btn-outline-danger">DISMISS</button>
    </ng-template>
</modal>