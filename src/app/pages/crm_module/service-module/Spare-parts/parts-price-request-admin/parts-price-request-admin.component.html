<ol class="flex font-semibold text-primary dark:text-white-dark">
    <li class="bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]">
        <a routerLink="/dashboard"
            class="relative flex h-full items-center p-1.5 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-3 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-3 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">Home</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180">Periodic
            Service</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center p-1.5 px-3 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-6 ltr:before:-right-[15px] rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">
            Requested Parts Price</a>
    </li>
</ol>

<div>
    <div class="panel mb-6 mt-6 pb-6">
        <h3 class="mb-4 text-lg font-semibold text-gray-800">Price Request</h3>

        <!-- Loader -->
        <div *ngIf="load_flag" class="text-center">
            <span
                class="m-auto mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"></span>
        </div>
        <div>
            <ng-container *ngIf="requestedPartPrices.length > 0; else noParts">
                <div *ngFor="let pkg of requestedPartPrices"
                    class="mb-4 rounded-xl border border-gray-200 bg-white p-4 shadow-sm hover:shadow-md transition dark:border-gray-700 dark:bg-gray-800">
                    <div class="flex items-center justify-between">

                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <h3 class="text-base font-semibold text-gray-900 dark:text-white">
                                    {{ pkg.spim_name }}
                                </h3>
                                <span
                                    class="rounded bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700 dark:bg-blue-900 dark:text-blue-300">
                                    {{ pkg.pm_code }}
                                </span>
                            </div>

                            <div
                                class="mt-1 flex flex-wrap items-center gap-3 text-xs text-gray-500 dark:text-gray-400">
                                <span>{{ pkg.brand_name }}</span>
                                <span>•</span>
                                <span>Requested by {{ getRequestedBy(pkg.pm_price_requested_by) }}</span>
                                <span>•</span>

                                <span class="flex items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 opacity-70" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>

                                    {{ pkg.pm_updated_on | date:'MMM d, y, h:mm a' }}
                                </span>
                            </div>

                            <div class="mt-2 flex flex-wrap items-center gap-4 text-sm">

                                <span
                                    class="bg-gray-100 dark:bg-gray-800 px-1 py-1 rounded text-red-400 dark:text-gray-300">
                                    Old: <strong>{{ pkg.pm_price }}</strong>
                                </span>

                                <span class="bg-green-100 dark:bg-green-900 px-2 py-1 rounded 
                                            text-green-700 dark:text-green-400 font-semibold
                                            animate-pulse">
                                    New: {{ pkg.pm_new_price }}
                                </span>

                                <span
                                    class="bg-indigo-100 dark:bg-indigo-900 px-2 py-1 rounded text-indigo-700 dark:text-indigo-400 font-medium">
                                    Affected Models: {{ pkg.model_count || 0 }}
                                </span>

                            </div>


                        </div>

                        <!-- RIGHT ACTIONS -->
                        <div class="flex gap-2 ml-4">
                            <button type="button"
                                class="rounded-md bg-blue-950 px-3 py-1 text-xs font-semibold text-white hover:bg-green-700"
                                (click)="acceptPrice(pkg)">
                                View Details
                            </button>

                            <!-- <button type="button"
                                class="rounded-md bg-red-600 px-3 py-1 text-xs font-semibold text-white hover:bg-red-700"
                                (click)="confirmCancelPrice(pkg)">
                                Decline
                            </button> -->
                        </div>
                    </div>
                </div>
            </ng-container>
            <ng-template #noParts>
                <div class="mt-4 text-center text-gray-500">No pending parts requests available.</div>
            </ng-template>
        </div>
    </div>
</div>