<ol class="flex font-semibold text-primary dark:text-white-dark">
    <li class="bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]">
        <a routerLink="/dashboard"
            class="relative flex h-full items-center p-1.5 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-3 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-3 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">Home</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180">
            Admin Settings</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a routerLink="/admin_spare_invoice"
            class="relative flex h-full items-center p-1.5 px-3 before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-[#ebedf2] before:border-t-transparent hover:text-primary/70 ltr:pl-6 ltr:before:-right-[15px] rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180 dark:before:border-l-[#1b2e4b] dark:hover:text-white-dark/70">
            Spare Invoice Approval</a>
    </li>
    <li class="bg-[#ebedf2] dark:bg-[#1b2e4b]">
        <a
            class="relative flex h-full items-center bg-primary p-1.5 text-white-light before:absolute before:inset-y-0 before:z-[1] before:m-auto before:h-0 before:w-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-b-transparent before:border-l-primary before:border-t-transparent ltr:pl-6 ltr:pr-2 ltr:before:-right-[15px] rtl:pl-2 rtl:pr-6 rtl:before:-left-[15px] rtl:before:rotate-180">
            Spare Invoice View</a>
    </li>
</ol>

<div class="panel mb-5 mt-5 pt-5">
    <div *ngIf="load_flag" style="text-align: center">
        <span
            class="m-auto mb-10 inline-block h-14 w-14 animate-[spin_3s_linear_infinite] rounded-full border-8 border-b-success border-l-primary border-r-warning border-t-danger align-middle"></span>
    </div>
    <div *ngIf="!load_flag">
        <div class="flex flex-wrap justify-between gap-4 px-4">
            <div class="text-2xl font-semibold uppercase">
                Spare Invoice - <b>#ALM{{ invoiceDetails.inv_nm_id }}</b>
            </div>
            <div class="shrink-0">
                <img src="./assets/images/alm_logo_l.png" alt="" style="width: 17rem" class="ltr:ml-auto rtl:mr-auto" />
            </div>
        </div>
        <div class="px-4 ltr:text-right rtl:text-left">
            <div class="mt-6 space-y-1 text-white-dark">
                <div>P.O Box: 9573, 12th Street, Mussafah 33,</div>
                <div>Abu Dhabi, UAE</div>
                <div>Tel: (02)5503552</div>
            </div>
        </div>
        <hr class="my-6 border-[#e0e6ed] dark:border-[#1b2e4b]" />
        <div class="flex flex-col justify-between gap-12 sm:flex-row">
            <div class="xl:1/2 sm:w-1/2 lg:w-1/2">
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">Customer :</div>
                    <div>{{ invoiceDetails.customer_name | uppercase }}</div>
                </div>
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">Phone :</div>
                    <div>{{invoiceDetails.phone}}</div>
                </div>
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">Reg No:</div>
                    <div>{{invoiceDetails.reg_no}}</div>
                </div>
                <div class="flex w-full items-center justify-between">
                    <div class="text-white-dark">Chassis :</div>
                    <div>{{invoiceDetails.chassis_no}}</div>
                </div>
            </div>
            <div class="xl:1/2 sm:w-1/2 lg:w-1/2">
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">JobCard:</div>
                    <div>{{invoiceDetails.inv_jobcard_no}}</div>
                </div>
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">Invoice Date:</div>
                    <div class="whitespace-nowrap">{{invoiceDetails.inv_created_on | date }}</div>
                </div>
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">Invoiced By:</div>
                    <div>{{invoiceDetails.us_firstname}}</div>
                </div>
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">TRN:</div>
                    <div>100262598400003</div>
                </div>
                <!-- 
                <div class="mb-2 flex w-full items-center justify-between">
                    <div class="text-white-dark">Country:</div>
                    <div>United States</div>
                </div> -->
            </div>
        </div>
        <div class="table-responsive mt-6">
            <h5 class="mb-3 text-lg font-semibold dark:text-white-light" style="text-align: center">Particulars</h5>
            <table class="table-striped">
                <thead>
                    <tr>
                        <th class="" style="width: 17%">PART CODE</th>
                        <th class="" style="width: 27%">DESCRIPTION</th>
                        <th class="" style="width: 8%">QUANTITY</th>
                        <th class="ltr:text-right rtl:text-left" style="width: 10%">UNIT PRICE</th>
                        <th class="ltr:text-right rtl:text-left" style="width: 10%">VAT</th>
                        <th class="ltr:text-right rtl:text-left" style="width: 10%">SUB TOTAL</th>
                        <th class="ltr:text-right rtl:text-left" style="width: 8%">MARGIN(%)</th>
                        <th class="ltr:text-right rtl:text-left" style="width: 10%">TOTAL</th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngFor="let spare of invoiceDetails.items">
                        <tr>
                            <td>{{ spare.inv_item_part_number }}</td>
                            <td>{{ spare.inv_item_description }}</td>
                            <td style="text-align: center">{{ spare.inv_item_qty }}</td>
                            <td class="ltr:text-right rtl:text-left">{{ spare.inv_item_nm_unit_price | number : '1.2-2'
                                }}</td>
                            <td class="ltr:text-right rtl:text-left">{{ spare.inv_item_nm_vat | number : '1.2-2' }}</td>
                            <td class="ltr:text-right rtl:text-left">
                                {{ spare.inv_item_qty * (spare.inv_item_nm_unit_price * 1 + spare.inv_item_nm_vat * 1) |
                                number : '1.2-2' }}
                            </td>
                            <td class="ltr:text-right rtl:text-left">
                                {{spare.inv_item_margin}}
                                <!-- <input id="parts_margin" type="text" style="text-align: right"
                                    [(ngModel)]="spare.inv_item_margin" placeholder="PARTS MARGIN (%)"
                                    class="form-input text-xs" maxlength="3" /> -->
                            </td>
                            <td class="ltr:text-right rtl:text-left">{{ spare.inv_item_margin_amount }}</td>
                        </tr>
                    </ng-container>
                </tbody>
                <tfoot>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th class="ltr:text-right rtl:text-left">
                            <b>{{ invoiceDetails.inv_nm_sub_total | number : '1.2-2' }}</b>
                        </th>
                        <th class="ltr:text-right rtl:text-left">
                            <b>{{ invoiceDetails.inv_nm_vat_total | number : '1.2-2' }}</b>
                        </th>
                        <th class="ltr:text-right rtl:text-left">
                            <b>{{ invoiceDetails.inv_nm_vat_total * 1 + invoiceDetails.inv_nm_sub_total * 1 | number :
                                '1.2-2' }}</b>
                        </th>
                        <th></th>
                        <th class="ltr:text-right rtl:text-left">
                            <b>{{ invoiceDetails.inv_alm_margin_total | number : '1.2-2' }}</b>
                        </th>
                    </tr>
                </tfoot>
            </table>
        </div>
        <div class="mt-6 grid grid-cols-1 px-4 sm:grid-cols-2">
            <div></div>
            <div class="space-y-2 ltr:text-right rtl:text-left">
                <div class="flex items-center">
                    <div class="flex-1">Subtotal</div>
                    <div class="w-[37%]">{{ invoiceDetails.inv_alm_margin_total - invoiceDetails.inv_alm_margin_total *
                        0.05 | number : '1.2-2' }}</div>
                </div>
                <div class="flex items-center">
                    <div class="flex-1">VAT</div>
                    <div class="w-[37%]">{{ invoiceDetails.inv_alm_margin_total * 0.05 | number : '1.2-2' }}</div>
                </div>
                <div class="flex items-center">
                    <div class="flex-1">Discount</div>
                    <div class="w-[37%]">
                        {{invoiceDetails.inv_alm_discount}}
                        <!-- <input id="parts_margin" type="number" style="text-align: right; width: 40%"
                            [(ngModel)]="invoiceDetails.inv_alm_discount" placeholder="Discount"
                            class="form-input text-xs" maxlength="5" /> -->
                    </div>
                </div>
                <div class="flex items-center text-lg font-semibold">
                    <div class="flex-1">Grand Total</div>
                    <div class="w-[37%]">AED {{ invoiceDetails.inv_alm_margin_total*1-
                        invoiceDetails.inv_alm_discount*1| number : '1.2-2' }}</div>
                </div>
            </div>
        </div>
        <div style="display: flex; justify-content: space-between" class="mt-5">
            <button type="button" class="btn btn-danger"  id="auto_trigger" 
                (click)="updateNMInvoice('1')">REJECT</button>
            <button type="button" class="btn btn-success"  id="auto_trigger" 
                (click)="updateNMInvoice('2')">APPROVE</button>
        </div>
    </div>
</div>